"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.paymeAuthentication = void 0;
const errors_1 = require("../errors");
async function paymeAuthentication(request, payme_password) {
    try {
        const token = request.headers['authorization'].split('Basic ')[1];
        const password = Buffer.from(token, 'base64').toString('ascii').split(':')[1];
        if (password != payme_password) {
            throw { message: 'Invalid password' };
        }
    }
    catch (error) {
        throw errors_1.PaymeErrors.Unauthorization();
    }
}
exports.paymeAuthentication = paymeAuthentication;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiaW5kZXguanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi8uLi9zcmMvbWlkZGxld2FyZS9pbmRleC50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOzs7QUFBQSxzQ0FBd0M7QUFFakMsS0FBSyxVQUFVLG1CQUFtQixDQUFDLE9BQU8sRUFBRSxjQUFjO0lBQzdELElBQUk7UUFDQSxNQUFNLEtBQUssR0FBRyxPQUFPLENBQUMsT0FBTyxDQUFDLGVBQWUsQ0FBQyxDQUFDLEtBQUssQ0FBQyxRQUFRLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQztRQUNsRSxNQUFNLFFBQVEsR0FBRyxNQUFNLENBQUMsSUFBSSxDQUFDLEtBQUssRUFBRSxRQUFRLENBQUMsQ0FBQyxRQUFRLENBQUMsT0FBTyxDQUFDLENBQUMsS0FBSyxDQUFDLEdBQUcsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDO1FBQzlFLElBQUksUUFBUSxJQUFJLGNBQWMsRUFBRTtZQUM1QixNQUFNLEVBQUUsT0FBTyxFQUFFLGtCQUFrQixFQUFFLENBQUE7U0FDeEM7S0FDSjtJQUFDLE9BQU8sS0FBSyxFQUFFO1FBQ1osTUFBTSxvQkFBVyxDQUFDLGVBQWUsRUFBRSxDQUFBO0tBQ3RDO0FBQ0wsQ0FBQztBQVZELGtEQVVDIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgUGF5bWVFcnJvcnMgfSBmcm9tIFwiLi4vZXJyb3JzXCI7XG5cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBwYXltZUF1dGhlbnRpY2F0aW9uKHJlcXVlc3QsIHBheW1lX3Bhc3N3b3JkKSB7XG4gICAgdHJ5IHtcbiAgICAgICAgY29uc3QgdG9rZW4gPSByZXF1ZXN0LmhlYWRlcnNbJ2F1dGhvcml6YXRpb24nXS5zcGxpdCgnQmFzaWMgJylbMV07XG4gICAgICAgIGNvbnN0IHBhc3N3b3JkID0gQnVmZmVyLmZyb20odG9rZW4sICdiYXNlNjQnKS50b1N0cmluZygnYXNjaWknKS5zcGxpdCgnOicpWzFdO1xuICAgICAgICBpZiAocGFzc3dvcmQgIT0gcGF5bWVfcGFzc3dvcmQpIHtcbiAgICAgICAgICAgIHRocm93IHsgbWVzc2FnZTogJ0ludmFsaWQgcGFzc3dvcmQnIH1cbiAgICAgICAgfVxuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgIHRocm93IFBheW1lRXJyb3JzLlVuYXV0aG9yaXphdGlvbigpXG4gICAgfVxufVxuIl19